todo             : train
dataset          : mnist
data_root        : /home/scape/datasets
log_root         : log
model_root       : /home/scape/checkpoint
load_checkpoint  : ./model/default/model.pth
affix            : l2
epsilon          : 0.314
alpha            : 0.15
k                : 10
batch_size       : 1
max_epoch        : 400
learning_rate    : 0.0001
gpu              : 0
n_eval_step      : 100
n_checkpoint_step : 2000
n_store_image_step : 2000
perturbation_type : l2
adv_train        : True
log_folder       : log/mnist_l2
model_folder     : /home/scape/checkpoint/mnist_l2

==================== evaluation at epoch: 1 iteration: 50 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 10.000% output margin in test: 0.0033392676711082457, output margin in val: 0.003921176156401634, all-layer margin in test: 0.0, all-layer margin in val: 0.09666559278350516
============================ end of evaluation ============================


==================== evaluation at epoch: 2 iteration: 100 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 16.000% output margin in test: 0.0027596539258956908, output margin in val: 0.0035788843244314193, all-layer margin in test: 0.0, all-layer margin in val: 0.10067846453398559
============================ end of evaluation ============================


==================== evaluation at epoch: 3 iteration: 150 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002192365825176239, output margin in val: 0.003440780368447304, all-layer margin in test: 0.0, all-layer margin in val: 0.10708470394736842
============================ end of evaluation ============================


==================== evaluation at epoch: 4 iteration: 200 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021921345591545106, output margin in val: 0.003440559759736061, all-layer margin in test: 0.0, all-layer margin in val: 0.08482058135121458
============================ end of evaluation ============================


==================== evaluation at epoch: 5 iteration: 250 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002187511920928955, output margin in val: 0.0034304262727499007, all-layer margin in test: 0.0, all-layer margin in val: 0.10068253121909002
============================ end of evaluation ============================


==================== evaluation at epoch: 6 iteration: 300 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002182730436325073, output margin in val: 0.0034240968346595764, all-layer margin in test: 0.0, all-layer margin in val: 0.0844046294504644
============================ end of evaluation ============================


==================== evaluation at epoch: 7 iteration: 350 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002179495096206665, output margin in val: 0.0034197920620441438, all-layer margin in test: 0.0, all-layer margin in val: 0.10530887882149902
============================ end of evaluation ============================


==================== evaluation at epoch: 8 iteration: 400 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021770626306533815, output margin in val: 0.003416645485162735, all-layer margin in test: 0.0, all-layer margin in val: 0.11354579714249748
============================ end of evaluation ============================


==================== evaluation at epoch: 9 iteration: 450 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002175170183181763, output margin in val: 0.0034142449140548707, all-layer margin in test: 0.0, all-layer margin in val: 0.10170631919412976
============================ end of evaluation ============================


==================== evaluation at epoch: 10 iteration: 500 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.00217366099357605, output margin in val: 0.003412355226278305, all-layer margin in test: 0.0, all-layer margin in val: 0.09319855300308008
============================ end of evaluation ============================


==================== evaluation at epoch: 11 iteration: 550 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002172429859638214, output margin in val: 0.0034108327358961105, all-layer margin in test: 0.0, all-layer margin in val: 0.10179966517857143
============================ end of evaluation ============================


==================== evaluation at epoch: 12 iteration: 600 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002171410620212555, output margin in val: 0.0034095802009105683, all-layer margin in test: 0.0, all-layer margin in val: 0.09544960315135895
============================ end of evaluation ============================


==================== evaluation at epoch: 13 iteration: 650 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021705520153045654, output margin in val: 0.0034085323095321657, all-layer margin in test: 0.0, all-layer margin in val: 0.11738162398580122
============================ end of evaluation ============================


==================== evaluation at epoch: 14 iteration: 700 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021698221564292906, output margin in val: 0.003407645520567894, all-layer margin in test: 0.0, all-layer margin in val: 0.10514646496023856
============================ end of evaluation ============================


==================== evaluation at epoch: 15 iteration: 750 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021691909432411194, output margin in val: 0.0034068820983171465, all-layer margin in test: 0.0, all-layer margin in val: 0.09491038602941176
============================ end of evaluation ============================


==================== evaluation at epoch: 16 iteration: 800 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002168644070625305, output margin in val: 0.003406223174929619, all-layer margin in test: 0.0, all-layer margin in val: 0.1053876201923077
============================ end of evaluation ============================


==================== evaluation at epoch: 17 iteration: 850 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002168164849281311, output margin in val: 0.0034056484311819077, all-layer margin in test: 0.0, all-layer margin in val: 0.10384759817888999
============================ end of evaluation ============================


==================== evaluation at epoch: 18 iteration: 900 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021677428483963014, output margin in val: 0.0034051419019699098, all-layer margin in test: 0.0, all-layer margin in val: 0.1233308399822695
============================ end of evaluation ============================


==================== evaluation at epoch: 19 iteration: 950 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021673652529716494, output margin in val: 0.0034046934276819227, all-layer margin in test: 0.0, all-layer margin in val: 0.10188020051301301
============================ end of evaluation ============================


==================== evaluation at epoch: 20 iteration: 1000 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021670308709144594, output margin in val: 0.003404292848706245, all-layer margin in test: 0.0, all-layer margin in val: 0.08697847406914894
============================ end of evaluation ============================


==================== evaluation at epoch: 21 iteration: 1050 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002166731953620911, output margin in val: 0.0034039372622966767, all-layer margin in test: 0.0, all-layer margin in val: 0.08358024738315482
============================ end of evaluation ============================


==================== evaluation at epoch: 22 iteration: 1100 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021664589643478394, output margin in val: 0.003403613606095314, all-layer margin in test: 0.0, all-layer margin in val: 0.09765625
============================ end of evaluation ============================


==================== evaluation at epoch: 23 iteration: 1150 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002166215479373932, output margin in val: 0.003403323331475258, all-layer margin in test: 0.0, all-layer margin in val: 0.11412722565406977
============================ end of evaluation ============================


==================== evaluation at epoch: 24 iteration: 1200 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021659937500953675, output margin in val: 0.0034030620843172074, all-layer margin in test: 0.0, all-layer margin in val: 0.09386409344059406
============================ end of evaluation ============================


==================== evaluation at epoch: 25 iteration: 1250 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002165791392326355, output margin in val: 0.003402822607755661, all-layer margin in test: 0.0, all-layer margin in val: 0.09584793845057034
============================ end of evaluation ============================


==================== evaluation at epoch: 26 iteration: 1300 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002165606617927551, output margin in val: 0.0034026078045368193, all-layer margin in test: 0.0, all-layer margin in val: 0.10313884104330709
============================ end of evaluation ============================


==================== evaluation at epoch: 27 iteration: 1350 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021654379367828367, output margin in val: 0.0034024060636758803, all-layer margin in test: 0.0, all-layer margin in val: 0.0866625381097561
============================ end of evaluation ============================


==================== evaluation at epoch: 28 iteration: 1400 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002165282070636749, output margin in val: 0.003402223190665245, all-layer margin in test: 0.0, all-layer margin in val: 0.11310531060222673
============================ end of evaluation ============================


==================== evaluation at epoch: 29 iteration: 1450 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002165137529373169, output margin in val: 0.003402051928639412, all-layer margin in test: 0.0, all-layer margin in val: 0.1116450359231943
============================ end of evaluation ============================


==================== evaluation at epoch: 30 iteration: 1500 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002165005803108215, output margin in val: 0.0034018995344638823, all-layer margin in test: 0.0, all-layer margin in val: 0.09078037129345604
============================ end of evaluation ============================


==================== evaluation at epoch: 31 iteration: 1550 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002164884805679321, output margin in val: 0.003401758751273155, all-layer margin in test: 0.0, all-layer margin in val: 0.08414713541666667
============================ end of evaluation ============================


==================== evaluation at epoch: 32 iteration: 1600 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021647727489471436, output margin in val: 0.0034016252249479293, all-layer margin in test: 0.0, all-layer margin in val: 0.10915317948868991
============================ end of evaluation ============================


==================== evaluation at epoch: 33 iteration: 1650 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021646687388420104, output margin in val: 0.0034015033096075056, all-layer margin in test: 0.0, all-layer margin in val: 0.08678611981832139
============================ end of evaluation ============================


==================== evaluation at epoch: 34 iteration: 1700 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002164568901062012, output margin in val: 0.0034013871997594833, all-layer margin in test: 0.0, all-layer margin in val: 0.11285202341445427
============================ end of evaluation ============================


==================== evaluation at epoch: 35 iteration: 1750 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021644791960716246, output margin in val: 0.003401281249523163, all-layer margin in test: 0.0, all-layer margin in val: 0.09548464327523414
============================ end of evaluation ============================


==================== evaluation at epoch: 36 iteration: 1800 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.00216439425945282, output margin in val: 0.003401184007525444, all-layer margin in test: 0.0, all-layer margin in val: 0.11462579257246377
============================ end of evaluation ============================


==================== evaluation at epoch: 37 iteration: 1850 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021643152832984923, output margin in val: 0.0034010925710201262, all-layer margin in test: 0.0, all-layer margin in val: 0.10068349810235064
============================ end of evaluation ============================


==================== evaluation at epoch: 38 iteration: 1900 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002164241373538971, output margin in val: 0.0034010054886341097, all-layer margin in test: 0.0, all-layer margin in val: 0.10285845360505451
============================ end of evaluation ============================


==================== evaluation at epoch: 39 iteration: 1950 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021641737222671507, output margin in val: 0.003400925663113594, all-layer margin in test: 0.0, all-layer margin in val: 0.1122139851006192
============================ end of evaluation ============================


==================== evaluation at epoch: 40 iteration: 2000 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021641093492507936, output margin in val: 0.0034008501917123794, all-layer margin in test: 0.0, all-layer margin in val: 0.09282136694785276
============================ end of evaluation ============================


==================== evaluation at epoch: 41 iteration: 2050 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021640485525131225, output margin in val: 0.0034007790744304657, all-layer margin in test: 0.0, all-layer margin in val: 0.09569629589160839
============================ end of evaluation ============================


==================== evaluation at epoch: 42 iteration: 2100 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021639931201934814, output margin in val: 0.003400713762640953, all-layer margin in test: 0.0, all-layer margin in val: 0.0849244304906542
============================ end of evaluation ============================


==================== evaluation at epoch: 43 iteration: 2150 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002163940966129303, output margin in val: 0.003400652804970741, all-layer margin in test: 0.0, all-layer margin in val: 0.10129306891025641
============================ end of evaluation ============================


==================== evaluation at epoch: 44 iteration: 2200 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021638885140419007, output margin in val: 0.00340059620141983, all-layer margin in test: 0.0, all-layer margin in val: 0.10791015625
============================ end of evaluation ============================


==================== evaluation at epoch: 45 iteration: 2250 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002163844406604767, output margin in val: 0.00340054250061512, all-layer margin in test: 0.0, all-layer margin in val: 0.10723250356463879
============================ end of evaluation ============================


==================== evaluation at epoch: 46 iteration: 2300 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002163800895214081, output margin in val: 0.0034004902511835097, all-layer margin in test: 0.0, all-layer margin in val: 0.10130378763089005
============================ end of evaluation ============================


==================== evaluation at epoch: 47 iteration: 2350 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021637603640556335, output margin in val: 0.0034004423558712006, all-layer margin in test: 0.0, all-layer margin in val: 0.11669214221014493
============================ end of evaluation ============================


==================== evaluation at epoch: 48 iteration: 2400 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002163720428943634, output margin in val: 0.003400397363305092, all-layer margin in test: 0.0, all-layer margin in val: 0.09436106542397661
============================ end of evaluation ============================


==================== evaluation at epoch: 49 iteration: 2450 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002163684070110321, output margin in val: 0.0034003552734851836, all-layer margin in test: 0.0, all-layer margin in val: 0.0850431944784525
============================ end of evaluation ============================


==================== evaluation at epoch: 50 iteration: 2500 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002163650095462799, output margin in val: 0.0034003131836652756, all-layer margin in test: 0.0, all-layer margin in val: 0.09003603146217265
============================ end of evaluation ============================


==================== evaluation at epoch: 51 iteration: 2550 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021636176109313967, output margin in val: 0.0034002768993377686, all-layer margin in test: 0.0, all-layer margin in val: 0.09574659217359051
============================ end of evaluation ============================


==================== evaluation at epoch: 52 iteration: 2600 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021635884046554564, output margin in val: 0.0034002406150102616, all-layer margin in test: 0.0, all-layer margin in val: 0.09253126575100806
============================ end of evaluation ============================


==================== evaluation at epoch: 53 iteration: 2650 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.002163560390472412, output margin in val: 0.0034002086848020554, all-layer margin in test: 0.0, all-layer margin in val: 0.10546875
============================ end of evaluation ============================


==================== evaluation at epoch: 54 iteration: 2700 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021635314822196963, output margin in val: 0.003400176754593849, all-layer margin in test: 0.0, all-layer margin in val: 0.11040325200850662
============================ end of evaluation ============================


==================== evaluation at epoch: 55 iteration: 2750 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021635067462921144, output margin in val: 0.0034001477271318435, all-layer margin in test: 0.0, all-layer margin in val: 0.09936126460873984
============================ end of evaluation ============================


==================== evaluation at epoch: 56 iteration: 2800 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.00216348260641098, output margin in val: 0.003400120151042938, all-layer margin in test: 0.0, all-layer margin in val: 0.10166101707884427
============================ end of evaluation ============================


==================== evaluation at epoch: 57 iteration: 2850 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021634605526924134, output margin in val: 0.0034000940263271334, all-layer margin in test: 0.0, all-layer margin in val: 0.09405865446891191
============================ end of evaluation ============================


==================== evaluation at epoch: 58 iteration: 2900 ====================
test acc: 9.740%, test adv acc: 9.800%, train acc: 14.000% output margin in test: 0.0021634382009506226, output margin in val: 0.0034000693529844285, all-layer margin in test: 0.0, all-layer margin in val: 0.10005877552998965
============================ end of evaluation ============================

